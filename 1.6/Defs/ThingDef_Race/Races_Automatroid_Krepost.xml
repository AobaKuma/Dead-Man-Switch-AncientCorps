<?xml version="1.0" encoding="utf-8"?>
<Defs>

  <ThingDef ParentName="BaseAncientAutomatroidRace">
    <defName>DMS_Mech_Krepost</defName>
    <label>Krepost</label>
    <description>6M41 / BR-6 "Krepost" NATO nicknamed "TankHead". Huge and bulky walker, used as a bridgehead and mobile battery to maintain frontal battlefield firepower, Krepost is equipped with several active protection system and reactive armors to resist incoming projectiles. Even if the shields are exhausted, its huge size and weapon systems are sufficient at holding off incoming enemies until reinforcements arrive.</description>
    <statBases>
      <MoveSpeed>2.7</MoveSpeed>
      <ArmorRating_Sharp>1.65</ArmorRating_Sharp><!--銳抗-->
      <ArmorRating_Blunt>1.00</ArmorRating_Blunt><!--鈍抗-->
      <ArmorRating_Heat>1.8</ArmorRating_Heat>  <!--能抗-->
      <StaggerDurationFactor>0</StaggerDurationFactor>
      <ShootingAccuracyPawn>2</ShootingAccuracyPawn>
      <BandwidthCost MayRequire="Ludeon.Rimworld.Biotech">6</BandwidthCost>        <!--帶寬消耗-->
      <WastepacksPerRecharge MayRequire="Ludeon.Rimworld.Biotech">6</WastepacksPerRecharge><!--充電/培養時產出廢料-->
    </statBases>
    <race>
      <mechFixedSkillLevel>12</mechFixedSkillLevel>
      <body>DMS_Bipedal</body>
      <nameGenerator>DMS_AncientMechHeavy</nameGenerator>
      <baseBodySize>3.25</baseBodySize>
      <baseHealthScale>5.5</baseHealthScale>
      <mechWeightClass>UltraHeavy</mechWeightClass>
      <detritusLeavings>
        <li>
          <def>DMS_ChunkSlag</def>
          <texOverrideIndex>7</texOverrideIndex>
          <spawnChance>0.4</spawnChance>
        </li>
        <li>
          <def>DMS_ChunkSlag</def>
          <texOverrideIndex>4</texOverrideIndex>
          <spawnChance>0.4</spawnChance>
        </li>
      </detritusLeavings>
    </race>
    <comps>
      <li Class="Fortified.CompProperties_VehicleWeapon">
        <drawData>
          <dataEast>
            <offset>(0.6,0,-0.6)</offset>
          </dataEast>
          <dataWest>
            <offset>(-0.4,0,1.1)</offset>
            <layer>-20</layer>
          </dataWest>
          <dataSouth>
            <offset>(-1.1,0,-0.2)</offset>
          </dataSouth>
          <dataNorth>
            <offset>(1.1,0,0.2)</offset>
          </dataNorth>
        </drawData>
        <turretRotationFollowPawn>true</turretRotationFollowPawn>
        <rotationSmoothTime>0.12</rotationSmoothTime>
      </li>
      <li Class="Fortified.CompPropertiesMultipleTurretGun">
        <subTurrets>
          <li>
            <ID>forward machinegun</ID>
            <turret>DMS_HeavyMachineGunMounted</turret>
            <autoAttack>true</autoAttack>
            <warmingTime>5</warmingTime>
            <angleOffset>-90</angleOffset>
            <renderNodeProperties>
              <li>
                <nodeClass>Fortified.PawnRenderNode_SubTurretGun</nodeClass>
                <workerClass>Fortified.PawnRenderNodeWorker_SubTurretGun</workerClass>
                <parentTagDef>Body</parentTagDef>
                <drawSize>1.75</drawSize>
                <baseLayer>-5</baseLayer>
                <pawnType>Any</pawnType>
                <drawData>
                  <dataEast>
                    <offset>(1.4,0,-0.05)</offset>
                  </dataEast>
                  <dataWest>
                    <offset>(-1.4,0,-0.05)</offset>
                    <rotationOffset>180</rotationOffset>
                  </dataWest>
                  <dataSouth>
                    <offset>(0.15,0,-1.30)</offset>
                  </dataSouth>
                  <dataNorth>
                    <offset>(-0.15,0,0.65)</offset>
                  </dataNorth>
                </drawData>
              </li>
            </renderNodeProperties>
          </li>
          <li>
            <ID>top machinegun</ID>
            <turret>DMS_Gun_KordTurret</turret>
            <autoAttack>true</autoAttack>
            <warmingTime>8</warmingTime>
            <angleOffset>-90</angleOffset>
            <renderNodeProperties>
              <li>
                <nodeClass>Fortified.PawnRenderNode_SubTurretGun</nodeClass>
                <workerClass>Fortified.PawnRenderNodeWorker_SubTurretGun</workerClass>
                <parentTagDef>Body</parentTagDef>
                <drawSize>2</drawSize>
                <baseLayer>20</baseLayer>
                <pawnType>Any</pawnType>
                <drawData>
                  <dataEast>
                    <offset>(-0.25,0,1)</offset>
                  </dataEast>
                  <dataWest>
                    <offset>(0.3,0,0.1)</offset>
                    <rotationOffset>180</rotationOffset>
                  </dataWest>
                  <dataSouth>
                    <offset>(0.45,0,0.5)</offset>
                    <rotationOffset>0</rotationOffset>
                  </dataSouth>
                  <dataNorth>
                    <offset>(-0.45,0,-0.5)</offset>
                    <rotationOffset>0</rotationOffset>
                  </dataNorth>
                </drawData>
              </li>
            </renderNodeProperties>
          </li>
          <li>
            <ID>ECM</ID>
            <turret>DMS_Gun_ECMSystem</turret>
            <autoAttack>true</autoAttack>
            <warmingTime>5</warmingTime>
            <angleOffset>-90</angleOffset>
            <IdleAngleOffset>-51</IdleAngleOffset>
            <renderNodeProperties>
              <li>
                <nodeClass>Fortified.PawnRenderNode_SubTurretGun</nodeClass>
                <workerClass>Fortified.PawnRenderNodeWorker_SubTurretGun</workerClass>
                <parentTagDef>Body</parentTagDef>
                <drawSize>0.75</drawSize>
                <baseLayer>20</baseLayer>
                <pawnType>Any</pawnType>
                <drawData>
                  <dataEast>
                    <offset>(1.2,0,1)</offset>
                    <layer>-1</layer>
                  </dataEast>
                  <dataWest>
                    <offset>(-1.15,0,-0.55)</offset>
                    <rotationOffset>180</rotationOffset>
                  </dataWest>
                  <dataSouth>
                    <offset>(0.85,0,-1.1)</offset>
                  </dataSouth>
                  <dataNorth>
                    <offset>(-0.85,0,0.7)</offset>
                    <layer>-1</layer>
                  </dataNorth>
                </drawData>
              </li>
            </renderNodeProperties>
          </li>
        </subTurrets>
      </li>
      <li Class="Fortified.CompProperties_MeleeSweep">
        <damageDef>Blunt</damageDef>
        <damage>40</damage>
        <armorPenetration>0.5</armorPenetration>
        <radius>3</radius>
        <angle>120</angle>
      </li>
    </comps>
    <modExtensions>
      <li Class="Fortified.MechWeaponExtension">
        <EnableWeaponFilter>true</EnableWeaponFilter>
        <UsableWeaponTags>
          <li MayRequire="vanillaexpanded.vwehw">HeavyGun</li><!--重型武器拓展-->
          <li>DMS_Tarbosaurus_Gun</li>
          <li>DMS_MechWeaponUltraHeavy</li>
          <li>DMS_MechWeaponHeavy</li>
          <li>H_Gatling20mm</li>
          <li>V_Gatling30mm</li>
          <li>2A38M</li>
          <li>DMS_DragoonGun</li>
          <li>DMS_VladimirovMachineGun</li>
          <li>DMS_MechWeaponTankGun</li>
        </UsableWeaponTags>
        <EnableTechLevelFilter>true</EnableTechLevelFilter>
        <UsableTechLevels>
          <li>Industrial</li>
        </UsableTechLevels>
      </li>
    </modExtensions>
    <tools Inherit="False">
      <li>
        <label>Mechanical Head</label>
        <capacities>
          <li>DMS_HeavySweep</li>
        </capacities>
        <power>35</power>
        <cooldownTime>6.5</cooldownTime>
        <linkedBodyPartsGroup>HeadAttackTool</linkedBodyPartsGroup>
        <ensureLinkedBodyPartsGroupAlwaysUsable>true</ensureLinkedBodyPartsGroupAlwaysUsable>
        <chanceFactor>0.08</chanceFactor>
        <surpriseAttack>
          <extraMeleeDamages>
            <li>
              <def>Stun</def>
              <amount>20</amount>
            </li>
          </extraMeleeDamages>
        </surpriseAttack>
      </li>
      <li>
        <label>Left Leg</label>
        <capacities>
          <li>DMS_HeavySweep</li>
        </capacities>
        <power>24</power>
        <cooldownTime>5</cooldownTime>
        <linkedBodyPartsGroup>LeftMechanicalLeg</linkedBodyPartsGroup>
        <ensureLinkedBodyPartsGroupAlwaysUsable>true</ensureLinkedBodyPartsGroupAlwaysUsable>
        <chanceFactor>0.2</chanceFactor>
        <surpriseAttack>
          <extraMeleeDamages>
            <li>
              <def>Stun</def>
              <amount>16</amount>
            </li>
          </extraMeleeDamages>
        </surpriseAttack>
      </li>
      <li>
        <label>Right Leg</label>
        <capacities>
          <li>DMS_HeavySweep</li>
        </capacities>
        <power>24</power>
        <cooldownTime>5</cooldownTime>
        <linkedBodyPartsGroup>RightMechanicalLeg</linkedBodyPartsGroup>
        <ensureLinkedBodyPartsGroupAlwaysUsable>true</ensureLinkedBodyPartsGroupAlwaysUsable>
        <chanceFactor>0.2</chanceFactor>
        <surpriseAttack>
          <extraMeleeDamages>
            <li>
              <def>Stun</def>
              <amount>16</amount>
            </li>
          </extraMeleeDamages>
        </surpriseAttack>
      </li>
    </tools>
    <damageMultipliers>
      <li>
        <damageDef>Blunt</damageDef>
        <multiplier>0.5</multiplier>
      </li>
      <li>
        <damageDef>Bomb</damageDef>
        <multiplier>0.5</multiplier>
      </li>
    </damageMultipliers>
    <butcherProducts>
      <Tungsteel>100</Tungsteel>
      <DMS_ChunkSlag>6</DMS_ChunkSlag>
      <ComponentStamped>4</ComponentStamped>
    </butcherProducts>
    <killedLeavingsPlayerHostile>
      <DMSAC_FacilityIntel>1</DMSAC_FacilityIntel>
    </killedLeavingsPlayerHostile>
    <castEdgeShadows>false</castEdgeShadows>
    <staticSunShadowHeight>0</staticSunShadowHeight>
  </ThingDef>

  <PawnKindDef ParentName="BaseAncientAutomatroidKind" Name="DMS_BaseKrepostKind">
    <defName>DMS_Mech_Krepost</defName>
    <label>BR-6 "Krepost"</label>
    <race>DMS_Mech_Krepost</race>
    <nameMaker>DMS_AncientMechHeavy</nameMaker>
    <isFighter>true</isFighter>
    <combatPower>500</combatPower>                                               <!--威脅點數-->
    <maxPerGroup>1</maxPerGroup>                                                 <!--單個集群內的數量-->
    <isBoss>true</isBoss>
    <lifeStages>                                                                 <!--身體圖片-->
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/krepost</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>4.2</drawSize>
          <shadowData>
            <volume>(1.25,1,1.25)</volume>
            <offset>(0,0,-0.5)</offset>
          </shadowData>
        </bodyGraphicData>
      </li>
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/krepost</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>4.2</drawSize>
          <shadowData>
            <volume>(1.25,1,1.25)</volume>
            <offset>(0,0,-0.5)</offset>
          </shadowData>
        </bodyGraphicData>
      </li>
    </lifeStages>
    <weaponTags Inherit="False">
      <li>DMS_MechWeaponTankGun</li>
    </weaponTags>
    <weaponMoney>7500~9999</weaponMoney>
    <abilities>
      <li>DMSAC_APS</li>
    </abilities>
  </PawnKindDef>

  <PawnKindDef ParentName="DMS_BaseKrepostKind">
    <defName>DMS_Mech_Krepost_Sweeper</defName>
    <label>BR-6/GP "Bashnya"</label>
    <combatPower>500</combatPower>
    <maxPerGroup>2</maxPerGroup>
    <weaponTags Inherit="False">
      <li>2A38M</li>
      <li>DMS_Gsh30Gatlinggun</li>
    </weaponTags>
  </PawnKindDef>
</Defs>