<?xml version="1.0" encoding="utf-8"?>
<Defs>
	<!--DMSAC_StugnaATGM-->
	<ThingDef ParentName="ApparelNoQualityBase">
		<defName>DMSAC_StugnaATGM</defName>
		<label>Stugna missile launcher</label>
		<description>A single-use anti-tank guided missile designed to be fired and discarded. effective against heavy mechs and even tanks. however to lock on target, it requires a long aiming time and clear line of sight.</description>
		<graphicData>
			<texPath>Things/Projectiles/DMS_9M133Missile/Icon</texPath>
			<drawSize>1</drawSize>
			<onGroundRandomRotateAngle>15</onGroundRandomRotateAngle>
			<graphicClass>Graphic_Single</graphicClass>
		</graphicData>
		<techLevel>Industrial</techLevel>
		<randomizeRotationOnSpawn>true</randomizeRotationOnSpawn>
		<tradeTags>
			<li>DMS_WeaponRanged</li>
		</tradeTags>
		<thingSetMakerTags>
			<li>RewardStandardHighFreq</li>
		</thingSetMakerTags>
		<stackLimit>4</stackLimit>
		<statBases>
			<Mass>18</Mass>
			<EquipDelay>3</EquipDelay>
			<MarketValue>1700</MarketValue>
			<MaxHitPoints>100</MaxHitPoints>
		</statBases>
		<tickerType>Never</tickerType>
		<thingCategories>
			<li>ApparelUtility</li>
		</thingCategories>
		<apparel>
			<countsAsClothingForNudity>false</countsAsClothingForNudity>
			<scoreOffset>-10</scoreOffset>
			<careIfWornByCorpse>false</careIfWornByCorpse>
			<careIfDamaged>false</careIfDamaged>
			<ignoredByNonViolent>true</ignoredByNonViolent>
			<wearPerDay>0</wearPerDay>
			<bodyPartGroups>
				<li>Waist</li>
			</bodyPartGroups>
			<layers>
				<li>Belt</li>
			</layers>
			<wornGraphicPath>Things/Projectiles/DMS_9M133Missile/apparel</wornGraphicPath>
			<wornGraphicData>
				<renderUtilityAsPack>true</renderUtilityAsPack>
				<north>
					<scale>0.75</scale>
					<offset>(-0.1,0)</offset>
					<hulk>
						<offset>(-0.15,-0.10)</offset>
					</hulk>
					<fat>
						<offset>(-0.15,-0.10)</offset>
					</fat>
				</north>
				<south>
					<scale>0.75</scale>
					<offset>(0.10,0.15)</offset>
					<hulk>
						<offset>(0.15,0)</offset>
					</hulk>
					<fat>
						<offset>(0.15,0)</offset>
					</fat>
				</south>
				<east>
					<offset>(-0.45,0)</offset>
					<scale>0.75</scale>
					<thin>
						<offset>(0,0.1)</offset>
					</thin>
					<hulk>
						<offset>(-0.15,0)</offset>
					</hulk>
					<fat>
						<offset>(-0.15,0)</offset>
					</fat>
					<male>
						<offset>(0,0.1)</offset>
					</male>
				</east>
				<west>
					<offset>(0.45,0)</offset>
					<scale>0.75</scale>
					<thin>
						<offset>(0,0.1)</offset>
					</thin>
					<hulk>
						<offset>(0.15,0)</offset>
					</hulk>
					<fat>
						<offset>(0.15,0)</offset>
					</fat>
					<male>
						<offset>(0,0.1)</offset>
					</male>
				</west>
			</wornGraphicData>
		</apparel>
		<resourceReadoutPriority>Middle</resourceReadoutPriority>
		<smeltable>false</smeltable>
		<burnableByRecipe>false</burnableByRecipe>
		<!-- <drawGUIOverlay>false</drawGUIOverlay> -->
		<verbs>
			<li>
				<commandIcon>Things/Projectiles/DMS_9M133Missile/VerbIcon</commandIcon>
				<verbClass>Verb_LaunchProjectile</verbClass>
				<hasStandardCommand>true</hasStandardCommand>
				<defaultProjectile>DMSAC_Bullet_9M133Missile</defaultProjectile>
				<minRange>9.9</minRange>
				<range>34.9</range>
				<warmupTime>3.5</warmupTime>
				<burstShotCount>1</burstShotCount>
				<soundCast>DMS_AC_Shot_GuidedMissile</soundCast>
				<soundCastTail>GunTail_Heavy</soundCastTail>
				<muzzleFlashScale>25</muzzleFlashScale>
				<targetable>true</targetable>
				<ai_IsBuildingDestroyer>true</ai_IsBuildingDestroyer>
				<ai_IsWeapon>false</ai_IsWeapon>
				<ai_AvoidFriendlyFireRadius>4</ai_AvoidFriendlyFireRadius>
				<aimingLineMote>DMS_Missile_Aim</aimingLineMote>
				<aimingLineMoteFixedLength>15.9</aimingLineMoteFixedLength>
				<aimingTargetMote>DMS_Missile_Target</aimingTargetMote>
				<soundAiming>DMS_Ability_LockOn</soundAiming>
				<targetParams>
					<canTargetLocations>true</canTargetLocations>
					<canTargetBuildings>true</canTargetBuildings>
					<canTargetPawns>true</canTargetPawns>
					<neverTargetIncapacitated>true</neverTargetIncapacitated>
				</targetParams>
				<requireLineOfSight>true</requireLineOfSight>
				<beamTargetsGround>true</beamTargetsGround>
				<forcedMissRadius>0.1</forcedMissRadius>
				<consumeFuelPerShot>1</consumeFuelPerShot>
			</li>
			<li>
			  <verbClass>Verb_LaunchProjectileStaticOneUse</verbClass>
			  <label>deploy turret</label>
			  <defaultProjectile>DMSAC_Grenade_Stugna</defaultProjectile>
			  <warmupTime>4</warmupTime>
			  <range>1.5</range>
			  <burstShotCount>1</burstShotCount>
			  <onlyManualCast>true</onlyManualCast>
			  <hasStandardCommand>true</hasStandardCommand>
			  <targetable>true</targetable>
			  <targetParams>
				<canTargetPawns>false</canTargetPawns>
				<canTargetBuildings>false</canTargetBuildings>
				<canTargetLocations>true</canTargetLocations>
			  </targetParams>
			  <soundCast>ThrowGrenade</soundCast>
			  <rangedFireRulepack>Combat_RangedFire_Thrown</rangedFireRulepack>
			  <canGoWild>false</canGoWild>
			</li>
		</verbs>
		<comps>
			<li Class="CompProperties_ApparelReloadable">
				<maxCharges>1</maxCharges>
				<destroyOnEmpty>true</destroyOnEmpty>
				<hotKey>Misc4</hotKey>
				<chargeNoun>charge</chargeNoun>
				<displayGizmoWhileUndrafted>false</displayGizmoWhileUndrafted>
			</li>
			<li Class="CompProperties_Styleable"></li>
		</comps>
	</ThingDef>

	<ThingDef ParentName="BaseGrenadeProjectile">
		<defName>DMSAC_Grenade_Stugna</defName>
		<label>stugna turret</label> 
		<thingClass>Projectile_SpawnsThing</thingClass>
		<graphicData>
		  <texPath>Things/Projectiles/DMS_9M133Missile/turret_icon</texPath>
		  <graphicClass>Graphic_Single</graphicClass>
		  <drawSize>1.2</drawSize>
		</graphicData>
		<projectile>
		  <explosionRadius>39.9</explosionRadius>
		  <speed>41</speed>
		  <spawnsThingDef>DMSAC_Turret_StugnaATGM</spawnsThingDef>
		  <tryAdjacentFreeSpaces>true</tryAdjacentFreeSpaces>
		</projectile>
	  </ThingDef>

	<ThingDef ParentName="BuildingBase">
		<defName>DMSAC_Turret_StugnaATGM</defName>
		<label>skif remote platform</label>
		<description>An anti-tank missile launcher platform that can be deployed and operated remotely. It will stop functioning once its battery runs out or no available rounds. If damaged sufficiently, it may explode.</description>
		<thingClass>Building_TurretGun</thingClass>
		<drawerType>MapMeshAndRealTime</drawerType>
		<uiIconPath>Things/Projectiles/DMS_9M133Missile/turret_icon</uiIconPath>
		<uiIconScale>1.2</uiIconScale>
		<graphicData>
			<texPath>Things/Projectiles/DMS_9M133Missile/tripod</texPath>
			<graphicClass>Graphic_Single</graphicClass>
			<damageData>
				<rect>(0.2,0.2,0.2,0.2)</rect>
			</damageData>
			<shadowData>
				<volume>(0.5,0.25,0.5)</volume>
				<offset>(0,0,-0.2)</offset>
			</shadowData>
			<drawOffset>(0,0,-0.1)</drawOffset>
			<drawSize>1</drawSize>
		</graphicData>
		<altitudeLayer>Building</altitudeLayer>
		<stealable>false</stealable>
		<rotatable>false</rotatable>
		<statBases>
			<MaxHitPoints>100</MaxHitPoints>
			<Flammability>0.7</Flammability>
			<WorkToBuild>1800</WorkToBuild>
			<Mass>18</Mass>
			<Beauty>-20</Beauty>
			<ShootingAccuracyTurret>0.96</ShootingAccuracyTurret>
		</statBases>
		<tickerType>Normal</tickerType>
		<comps>
			<li Class="CompProperties_Explosive">
				<compClass>CompExplosivePowered</compClass>
				<wickTicks>240</wickTicks>
				<explosiveRadius>3.9</explosiveRadius>
				<explosiveDamageType>Bomb</explosiveDamageType>
				<chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
			</li>
			<li Class="CompProperties_Breakdownable" />
			<li Class="CompProperties_Stunnable">
				<affectedDamageDefs>
					<li>Stun</li>
					<li>EMP</li>
				</affectedDamageDefs>
				<adaptableDamageDefs>
					<li>EMP</li>
				</adaptableDamageDefs>
			</li>
			<li Class="CompProperties_Refuelable">
			  <fuelLabel>missile shots</fuelLabel>
			  <fuelGizmoLabel>loaded missile</fuelGizmoLabel>
			  <outOfFuelMessage>Cannot fire: Needs missile round.</outOfFuelMessage>
			  <fuelFilter>
				<thingDefs>
				  <li>DMSAC_StugnaATGM</li>
				</thingDefs>
			  </fuelFilter>
			  <fuelIsMortarBarrel>false</fuelIsMortarBarrel>
			  <fuelCapacity>1</fuelCapacity>    <!-- 25 burst -->
			  <fuelMultiplier>1</fuelMultiplier><!-- 1 Barrel=25 ammo -->
			  <initialFuelPercent>1</initialFuelPercent>
			  <showFuelGizmo>true</showFuelGizmo>
			  <minimumFueledThreshold>1</minimumFueledThreshold>
			  <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
			  <initialAllowAutoRefuel>true</initialAllowAutoRefuel>
			  <targetFuelLevelConfigurable>false</targetFuelLevelConfigurable>              <!--重裝填設定-->
			  <initialConfigurableTargetFuelLevel>1</initialConfigurableTargetFuelLevel>
			  <autoRefuelPercent>1</autoRefuelPercent>
			  <fuelIconPath>Things/Projectiles/DMS_9M133Missile/Icon</fuelIconPath>
			</li>
			<li Class="CompProperties_MechPowerCell">
				<totalPowerTicks>30000</totalPowerTicks>
				<killWhenDepleted>false</killWhenDepleted>
				<labelOverride>Battery power</labelOverride>
				<tooltipOverride>This turret has a limited battery life. Once it runs out, it will stop working entirely.</tooltipOverride>
			</li>
		</comps>
		<passability>PassThroughOnly</passability>
		<pathCost>50</pathCost>
		<fillPercent>0.4</fillPercent>
		<hasTooltip>true</hasTooltip>
		<costList>
			<Steel>40</Steel>
		</costList>
		<terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
		<building>
			<combatPower>45</combatPower>   <!-- same as a scavenger -->
			<ai_combatDangerous>true</ai_combatDangerous>
			<turretGunDef>DMSAC_Gun_StugnaATGM</turretGunDef>
			<turretBurstWarmupTime>1.5</turretBurstWarmupTime>
			<turretBurstCooldownTime>2.4</turretBurstCooldownTime>
			<claimable>false</claimable>
			<expandHomeArea>false</expandHomeArea>
			<turretTopDrawSize>1.2</turretTopDrawSize>
		</building>
		<placeWorkers>
			<li>PlaceWorker_TurretTop</li>
			<li>PlaceWorker_ShowTurretRadius</li>
		</placeWorkers>
		<designationHotKey>Misc2</designationHotKey>
		<modExtensions>
			<li Class="Fortified.ForceTargetableExtension"/>
		</modExtensions>
	</ThingDef>
	<ThingDef ParentName="BaseWeaponTurret">
		<defName>DMSAC_Gun_StugnaATGM</defName>
		<label>Stugna ATGM</label>
		<description>A Stugna anti-tank missile system mounted on a remote aiming platform.</description>
		<graphicData>
			<texPath>Things/Projectiles/DMS_9M133Missile/gun</texPath>
			<graphicClass>Graphic_Single</graphicClass>
		</graphicData>
		<statBases>
			<RangedWeapon_Cooldown>4.8</RangedWeapon_Cooldown>
			<DeteriorationRate>0</DeteriorationRate>
			<Mass>15</Mass>
			<Flammability>0</Flammability>
		</statBases>
		<verbs>
			<li>
				<commandIcon>Things/Projectiles/DMS_9M133Missile/VerbIcon</commandIcon>
				<verbClass>Verb_Shoot</verbClass>
				<hasStandardCommand>true</hasStandardCommand>
				<defaultProjectile>DMSAC_Bullet_9M133Missile</defaultProjectile>
				<minRange>9.9</minRange>
				<range>39.9</range>
				<warmupTime>3.5</warmupTime>
				<burstShotCount>1</burstShotCount>
				<soundCast>DMS_AC_Shot_GuidedMissile</soundCast>
				<soundCastTail>GunTail_Heavy</soundCastTail>
				<muzzleFlashScale>25</muzzleFlashScale>
				<targetable>true</targetable>
				<ai_IsBuildingDestroyer>true</ai_IsBuildingDestroyer>
				<ai_IsWeapon>true</ai_IsWeapon>
				<ai_AvoidFriendlyFireRadius>4</ai_AvoidFriendlyFireRadius>
				<soundAiming>DMS_Ability_LockOn</soundAiming>
				<targetParams>
					<canTargetLocations>true</canTargetLocations>
					<canTargetBuildings>true</canTargetBuildings>
					<canTargetPawns>true</canTargetPawns>
					<neverTargetIncapacitated>true</neverTargetIncapacitated>
				</targetParams>
				<requireLineOfSight>true</requireLineOfSight>
				<beamTargetsGround>true</beamTargetsGround>
				<forcedMissRadius>0.1</forcedMissRadius>
				<consumeFuelPerShot>1</consumeFuelPerShot>
			</li>
		</verbs>
	</ThingDef>
</Defs>